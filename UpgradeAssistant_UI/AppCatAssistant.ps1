param(
     [string]$appcatAssistantPath,
     [string]$solutionPath,
)

if (-not $appcatAssistantPath -or -not (Test-Path -Path $appcatAssistantPath) -or -not $solutionPath){
$errorMessage = "Error: .Net Upgrade Assistant Path or Solution path is is missing or incorrect."  
Write-Host $errorMessage
exit 1
}

if (-not (Test-Path -Path $solutionPath )){
$errorMessage = "Error: Solution file not found." 
Write-Host $errorMessage
exit 1
}

try
{
    Write-Host "Analysis Started..."
    $analysisOutput = & $AppCatAssistantPath analyze $solutionPath
    Write-Host "Analysis Completed..."
}
catch{
$errorMessage = $_.Exception.Message
 Write-Host "Error occured: $errorMessage"
}
# SIG # Begin signature block
# MIIKdwYJKoZIhvcNAQcCoIIKaDCCCmQCAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB
# gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR
# AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQU4LidRsTZF78QpmcX6tUhkL+o
# 2RCgggfNMIIHyTCCBbGgAwIBAgITfgAgCz3Z3MPDcN7A7QAAACALPTANBgkqhkiG
# 9w0BAQsFADBcMRMwEQYKCZImiZPyLGQBGRYDY29tMRcwFQYKCZImiZPyLGQBGRYH
# bXBoYXNpczEUMBIGCgmSJomT8ixkARkWBGNvcnAxFjAUBgNVBAMTDU1waGFzaXNS
# b290Q0EwHhcNMjMxMjE4MDMyNTQyWhcNMjUxMjE3MDMyNTQyWjCBljETMBEGCgmS
# JomT8ixkARkWA2NvbTEXMBUGCgmSJomT8ixkARkWB21waGFzaXMxFDASBgoJkiaJ
# k/IsZAEZFgRjb3JwMRUwEwYDVQQLEwxNcGhhc2lTIEFwcHMxEjAQBgNVBAsTCUh5
# ZGVyYWJhZDEOMAwGA1UECxMFVXNlcnMxFTATBgNVBAMTDFNoaXZhcmVkZHkgTTCC
# ASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKyvPCQ385Fjz/4U6Tp+KKKb
# EayL/ZPbC24BjdukuPcOgDgBtUE6G+q9xwOJZR/d+qRbYmeAne3nJp76oVjMKMM9
# DI/vLqwHnoI0IW536krgYRw3itaiB7G/FaRgW2ZXIMSbbalpdbgOEtGSB2ql4rOB
# YfLOrardFJE8scxayoorr+Z6/wlNDb6PGH6Jxyq4sLPjdoTy/UGhV3bbqnorkZ/M
# oBv2GeHLV3o0+oY+u+iM0JyeXqvcww3DbOce7iHrHhd2/ITF/3+Ltz3UJCixLzpz
# Bucxc7dTRNSHQRxG1cQc/LmPvF/6cWb9V4w7bkcfVGACjoLg7mqJ05stGLIXcdkC
# AwEAAaOCA0cwggNDMDsGCSsGAQQBgjcVBwQuMCwGJCsGAQQBgjcVCITMgh/PvRuC
# 1Y0bs8c1hobpLIFAhpn3A6yaEwIBZAIBDjATBgNVHSUEDDAKBggrBgEFBQcDAzAL
# BgNVHQ8EBAMCB4AwGwYJKwYBBAGCNxUKBA4wDDAKBggrBgEFBQcDAzAdBgNVHQ4E
# FgQUm0Uq8NbrG7Pjt5k44d1/yYo10gwwHwYDVR0jBBgwFoAUI0Ukc9Y9Vxhp+CPV
# qTHHVKhx7Y0wgdsGA1UdHwSB0zCB0DCBzaCByqCBx4aBxGxkYXA6Ly8vQ049TXBo
# YXNpc1Jvb3RDQSxDTj1TUlZCQU4wOUNSQVVWTTEsQ049Q0RQLENOPVB1YmxpYyUy
# MEtleSUyMFNlcnZpY2VzLENOPVNlcnZpY2VzLENOPUNvbmZpZ3VyYXRpb24sREM9
# Y29ycCxEQz1tcGhhc2lzLERDPWNvbT9jZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0
# P2Jhc2U/b2JqZWN0Q2xhc3M9Y1JMRGlzdHJpYnV0aW9uUG9pbnQwggEBBggrBgEF
# BQcBAQSB9DCB8TCBtAYIKwYBBQUHMAKGgadsZGFwOi8vL0NOPU1waGFzaXNSb290
# Q0EsQ049QUlBLENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZpY2Vz
# LENOPUNvbmZpZ3VyYXRpb24sREM9Y29ycCxEQz1tcGhhc2lzLERDPWNvbT9jQUNl
# cnRpZmljYXRlP2Jhc2U/b2JqZWN0Q2xhc3M9Y2VydGlmaWNhdGlvbkF1dGhvcml0
# eTA4BggrBgEFBQcwAYYsaHR0cDovL1NSVkJBTjA5Q1JBVVZNMS5jb3JwLm1waGFz
# aXMuY29tL29jc3AwTQYDVR0RBEYwRKAoBgorBgEEAYI3FAIDoBoMGHNoaXZhcmVk
# ZHkubUBtcGhhc2lzLmNvbYEYc2hpdmFyZWRkeS5tQG1waGFzaXMuY29tMFMGCSsG
# AQQBgjcZAgRGMESgQgYKKwYBBAGCNxkCAaA0BDJTLTEtNS0yMS0xMDc5NTc2NTIz
# LTM4NTgxMjM1NjUtMTkwOTY3OTkxNS0xMDAyNTIzMjANBgkqhkiG9w0BAQsFAAOC
# AgEA2Avj9jCR7RZhFJtKMnaZfv2GE/aZXyXuMWPqzDTqEreACu1Mptr/TNt7QEFW
# +9XzWmTBn/j7czQwfUFjm4TUuEmDuJWUvqnLYMYmiqU6/Y4ht+VguERaT5GSJpRy
# d5vapy7tcKHchW0n1Jux0qkq2m3/G4d+xg7Fopc4sdpk5tEhGwqPZf8yEx+ExqdX
# C+HNkUiueMLpJrBVXWgx51Udo4HnGaYYjkQ2SiXYQxVm6kyoysBblRjC0g/Kebxb
# EaDtB7RQhrG7MM4Ge0nXF/oFA34SRu8tLdYuCUdoJldj7cXzBVXPAKLX2Zi6ZTcx
# K3WYPIb3oCZcUlOvs5xSOY9cAnVnjVbrX6O9jk0/YHRIhmHU//0cmJEqokGiNDYS
# mY2pHy0BNLPH7j9PXSZV5MjZL0ZsH9rs8tqpxDsSNiy8spZR8m+guPGSodqwjgol
# 2nc6LEy92OJX11FPUJK2Nm9HJsNqP/xSukzH8SMtFlCOS3uROcbMmfoGrB61JFQ1
# 6D2uFOfw97tyqPpsVm8ZnhjD8qhDigovVH/vveoxVOxLbdHxbC5nWLQTv80p0CTS
# aKL5pLF0OIIiv+llvolx0ftcYBw9pBed876MQPJunnTgO52EnvES+4US3uEg2leg
# +UBfMc44Q1GyzqHsz26TPM2AXg1pfv2NHuTKOO5FSwp+CpAxggIUMIICEAIBATBz
# MFwxEzARBgoJkiaJk/IsZAEZFgNjb20xFzAVBgoJkiaJk/IsZAEZFgdtcGhhc2lz
# MRQwEgYKCZImiZPyLGQBGRYEY29ycDEWMBQGA1UEAxMNTXBoYXNpc1Jvb3RDQQIT
# fgAgCz3Z3MPDcN7A7QAAACALPTAJBgUrDgMCGgUAoHgwGAYKKwYBBAGCNwIBDDEK
# MAigAoAAoQKAADAZBgkqhkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3
# AgELMQ4wDAYKKwYBBAGCNwIBFTAjBgkqhkiG9w0BCQQxFgQUh0mlHmqYUck3Rvwh
# 5hUDbJotoWUwDQYJKoZIhvcNAQEBBQAEggEAeMS4d1HzXyKweNJIsN9FqayO4/1q
# sTkp7tuP7Ib9TBOqZdpbZCclEHAp97RhR+ySGhak5Aim12QlUhGd3FwB0yeiQcyQ
# KoHfze7X9dT8ZerWxLhjuNdnn73W2V53BYitNPUWYfKqy0vbrAxLBjlIsMI7Th+/
# j0cVzdoWBJk+jIG0et55LHFnjO3uDBiSyuu2yetojf1kroezoABB3DeEH0xUUtSp
# QOgueCve7i4i2aoB8+kcwg+OLSol/DNv4XnuGh4K5u4I6hQc4fjHc8nCkBEfPaCI
# h7s0PTOvq3k7CTjSIzHBB4c4ApYBiom6O3mX6TRJHOIQcl4P1zdMSSM45g==
# SIG # End signature block
